import{r,c as p,a as n,b as s,w as a,F as c,d as o,e,o as i}from"./app.138b5321.js";import{_ as d}from"./plugin-vue_export-helper.5a098b48.js";const _={},u=o('<h1 id="ngx-stream-keyval-module" tabindex="-1"><a class="header-anchor" href="#ngx-stream-keyval-module" aria-hidden="true">#</a> ngx_stream_keyval_module</h1><ul><li><a href="#example_configuration">\u793A\u4F8B\u914D\u7F6E</a></li><li><a href="#directives">\u6307\u4EE4</a><ul><li><a href="#keyval">keyval</a></li><li><a href="#keyval_zone">keyval_zone</a></li></ul></li></ul>',2),k=n("code",null,"ngx_stream_keyval_module",-1),h=e(" \u6A21\u5757\uFF081.13.7\uFF09\u53EF\u7528\u4E8E\u521B\u5EFA\u53D8\u91CF\uFF0C\u53D8\u91CF\u7684\u503C\u4ECE\u7531 "),m=e("API"),y=e(" \u7BA1\u7406\u7684\u952E\u503C\u5BF9\u4E2D\u83B7\u53D6\u3002"),b=e("\u6B64\u6A21\u5757\u4E3A"),g={href:"http://nginx.com/products/?_ga=2.203887064.99786210.1588592638-1615340879.1588592638",target:"_blank",rel:"noopener noreferrer"},v=e("\u5546\u4E1A\u8BA2\u9605"),f=e("\u90E8\u5206\u3002"),x=o(`<p><a id="example_configuration"></a></p><h2 id="\u793A\u4F8B\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u793A\u4F8B\u914D\u7F6E" aria-hidden="true">#</a> \u793A\u4F8B\u914D\u7F6E</h2><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>

    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        ...
        <span class="token directive"><span class="token keyword">location</span> /api</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">api</span> write=on</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token directive"><span class="token keyword">stream</span></span> <span class="token punctuation">{</span>

    <span class="token directive"><span class="token keyword">keyval_zone</span> zone=one:32k state=one.keyval</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">keyval</span>      <span class="token variable">$ssl_server_name</span> <span class="token variable">$name</span> zone=one</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">listen</span>              <span class="token number">12345</span> ssl</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span>          <span class="token variable">$name</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">ssl_certificate</span>     /usr/local/nginx/conf/cert.pem</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">ssl_certificate_key</span> /usr/local/nginx/conf/cert.key</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><a id="directives"></a></p><h2 id="\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u6307\u4EE4" aria-hidden="true">#</a> \u6307\u4EE4</h2><h3 id="keyval" tabindex="-1"><a class="header-anchor" href="#keyval" aria-hidden="true">#</a> keyval</h3><table><thead><tr><th style="text-align:left;">-</th><th style="text-align:left;">\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>\u8BED\u6CD5</strong></td><td style="text-align:left;"><strong>keyval</strong> <code>key $variable zone=name</code>;</td></tr><tr><td style="text-align:left;"><strong>\u9ED8\u8BA4</strong></td><td style="text-align:left;">\u2014\u2014</td></tr><tr><td style="text-align:left;"><strong>\u4E0A\u4E0B\u6587</strong></td><td style="text-align:left;">stream</td></tr></tbody></table><p>\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684 <code>$variable</code>\uFF0C\u5176\u503C\u5728\u952E\u503C\u6570\u636E\u5E93\u4E2D\u901A\u8FC7 key \u67E5\u627E\u3002\u5339\u914D\u89C4\u5219\u7531 <a href="#keyval_zone">keyval_zone</a> \u6307\u4EE4\u7684 <a href="#keyval_type">type</a> \u53C2\u6570\u5B9A\u4E49\u3002\u6570\u636E\u5E93\u5B58\u50A8\u5728 <code>zone</code> \u53C2\u6570\u6307\u5B9A\u7684\u5171\u4EAB\u5185\u5B58\u533A\u57DF\u4E2D\u3002</p><h3 id="keyval-zone" tabindex="-1"><a class="header-anchor" href="#keyval-zone" aria-hidden="true">#</a> keyval_zone</h3><table><thead><tr><th style="text-align:left;">-</th><th style="text-align:left;">\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>\u8BED\u6CD5</strong></td><td style="text-align:left;"><strong>keyval_zone</strong> <code>zone=name:size [state=file] [timeout=time] [type=string|ip|prefix] [sync]</code>;</td></tr><tr><td style="text-align:left;"><strong>\u9ED8\u8BA4</strong></td><td style="text-align:left;">\u2014\u2014</td></tr><tr><td style="text-align:left;"><strong>\u4E0A\u4E0B\u6587</strong></td><td style="text-align:left;">stream</td></tr></tbody></table>`,10),E=e("\u8BBE\u7F6E\u7EF4\u6301\u952E\u503C\u6570\u636E\u5E93\u7684\u5171\u4EAB\u5185\u5B58\u533A\u57DF\u7684\u540D\u79F0\uFF08"),z=n("code",null,"name",-1),w=e("\uFF09\u548C\u5927\u5C0F\uFF08"),A=n("code",null,"size",-1),D=e("\uFF09\u3002\u952E\u503C\u5BF9\u901A\u8FC7 "),F=e("API"),I=e(" \u8FDB\u884C\u7BA1\u7406\u3002"),$=o('<p>\u53EF\u9009\u7684 <code>state</code> \u53C2\u6570\u6307\u5B9A\u4E00\u4E2A\u6587\u4EF6\uFF08<code>file</code>\uFF09\uFF0C\u8BE5\u6587\u4EF6\u4EE5 JSON \u683C\u5F0F\u4FDD\u5B58\u952E\u503C\u6570\u636E\u5E93\u7684\u5F53\u524D\u72B6\u6001\uFF0C\u5E76\u5728\u91CD\u65B0\u542F\u52A8 nginx \u65F6\u4FDD\u6301\u4E0D\u53D8\u3002</p><p>\u53EF\u9009\u7684 <code>timeout</code> \u53C2\u6570\uFF081.15.0\uFF09\u8BBE\u7F6E\u5C06\u952E\u503C\u5BF9\u4ECE\u533A\u57DF\u4E2D\u5220\u9664\u7684\u65F6\u95F4\u3002</p><p>\u53EF\u9009\u7684 <code>type</code> \u53C2\u6570\uFF081.17.1\uFF09\u6FC0\u6D3B\u4E00\u4E2A\u989D\u5916\u7684\u7D22\u5F15\uFF0C\u8BE5\u7D22\u5F15\u9488\u5BF9\u67D0\u79CD\u7C7B\u578B\u7684\u952E\u5339\u914D\u8FDB\u884C\u4E86\u4F18\u5316\uFF0C\u5339\u914D\u89C4\u5219\u5728\u8BA1\u7B97<a href="#keyval">\u952E\u503C</a> <code>$variable</code> \u65F6\u5B9A\u4E49\u3002</p><blockquote><p>\u7D22\u5F15\u5B58\u50A8\u5728\u76F8\u540C\u7684\u5171\u4EAB\u5B58\u50A8\u533A\u4E2D\uFF0C\u56E0\u6B64\u9700\u8981\u989D\u5916\u7684\u5B58\u50A8\u3002</p></blockquote><ul><li><p><code>type=string</code></p><p>\u9ED8\u8BA4\u914D\u7F6E\uFF0C\u4E0D\u542F\u7528\u7D22\u5F15\uFF1B\u4F7F\u7528\u8BB0\u5F55 key \u548C\u4E00\u4E2A\u641C\u7D22 key \u7684\u5B8C\u5168\u5339\u914D\u6765\u6267\u884C\u53D8\u91CF\u67E5\u627E</p></li><li><p><code>type=ip</code></p><p>\u641C\u7D22 key \u662F IPv4 \u6216 IPv6 \u5730\u5740\u6216 CIDR \u8303\u56F4\u7684\u6587\u5B57\u8868\u793A\uFF1B\u8981\u5339\u914D\u8BB0\u5F55 key\uFF0C\u641C\u7D22 key \u5FC5\u987B\u5C5E\u4E8E\u8BB0\u5F55 key \u6307\u5B9A\u7684\u5B50\u7F51\u6216\u4E0E IP \u5730\u5740\u5B8C\u5168\u5339\u914D</p></li><li><p><code>type=prefix</code></p><p>\u4F7F\u7528\u8BB0\u5F55 key \u548C\u641C\u7D22 key \u7684\u524D\u7F00\u5339\u914D\uFF081.17.5\uFF09\u6267\u884C\u53D8\u91CF\u67E5\u627E\uFF1B\u8981\u4E0E\u8BB0\u5F55 key \u5339\u914D\uFF0C\u8BB0\u5F55 key \u5FC5\u987B\u662F\u641C\u7D22 key \u7684\u524D\u7F00</p></li></ul>',5),N=e("\u53EF\u9009\u7684 "),P=n("code",null,"sync",-1),V=e(" \u53C2\u6570\uFF081.15.0\uFF09\u542F\u7528\u5171\u4EAB\u5185\u5B58\u533A\u57DF"),q=e("\u540C\u6B65"),L=e("\u3002\u540C\u6B65\u8981\u6C42\u8BBE\u7F6E\u8D85\u65F6\uFF08"),S=n("code",null,"timeout",-1),B=e("\uFF09\u53C2\u6570\u3002"),C=e("\u5982\u679C\u542F\u7528\u4E86\u540C\u6B65\uFF0C\u5219\u5C06\u4EC5\u5728\u76EE\u6807\u7FA4\u96C6\u8282\u70B9\u4E0A\u6267\u884C\u952E\u503C\u5BF9\uFF08\u65E0\u8BBA\u662F"),K=e("\u4E00\u4E2A"),O=e("\u8FD8\u662F"),R=e("\u5168\u90E8"),j=e("\uFF09\u7684\u5220\u9664\u64CD\u4F5C\u3002\u7ECF\u8FC7 "),Z=n("code",null,"timeout",-1),J=e(" \u65F6\u95F4\u540E\uFF0C\u5C06\u5220\u9664\u5176\u4ED6\u7FA4\u96C6\u8282\u70B9\u4E0A\u76F8\u540C\u7684\u952E\u503C\u5BF9\u3002"),T=n("h2",{id:"\u539F\u6587\u6863",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u539F\u6587\u6863","aria-hidden":"true"},"#"),e(" \u539F\u6587\u6863")],-1),G={href:"http://nginx.org/en/docs/stream/ngx_stream_keyval_module.html",target:"_blank",rel:"noopener noreferrer"},H=e("http://nginx.org/en/docs/stream/ngx_stream_keyval_module.html");function M(Q,U){const t=r("RouterLink"),l=r("OutboundLink");return i(),p(c,null,[u,n("p",null,[k,h,s(t,{to:"/%E6%A8%A1%E5%9D%97%E5%8F%82%E8%80%83/stream/ngx_http_api_module.html#stream_keyvals_"},{default:a(()=>[m]),_:1}),y]),n("blockquote",null,[n("p",null,[b,n("a",g,[v,s(l)]),f])]),x,n("p",null,[E,z,w,A,D,s(t,{to:"/%E6%A8%A1%E5%9D%97%E5%8F%82%E8%80%83/stream/ngx_http_api_module.html#stream_keyvals_"},{default:a(()=>[F]),_:1}),I]),$,n("p",null,[N,P,V,s(t,{to:"/%E6%A8%A1%E5%9D%97%E5%8F%82%E8%80%83/stream/ngx_stream_zone_sync_module.html#zone_sync"},{default:a(()=>[q]),_:1}),L,S,B]),n("blockquote",null,[n("p",null,[C,s(t,{to:"/%E6%A8%A1%E5%9D%97%E5%8F%82%E8%80%83/stream/ngx_http_api_module.html#patchStreamKeyvalZoneKeyValue"},{default:a(()=>[K]),_:1}),O,s(t,{to:"/%E6%A8%A1%E5%9D%97%E5%8F%82%E8%80%83/stream/ngx_http_api_module.html#deleteStreamKeyvalZoneData"},{default:a(()=>[R]),_:1}),j,Z,J])]),T,n("ul",null,[n("li",null,[n("a",G,[H,s(l)])])])],64)}var Y=d(_,[["render",M]]);export{Y as default};
